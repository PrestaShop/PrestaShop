parameters:
    AdapterSecurityAdminClass:                LegacyTests\PrestaShopBundle\Mock\AdapterSecurityAdminMock
    prestashop.security.voter.product.class:  LegacyTests\PrestaShopBundle\Mock\PageVoter
    ps_tmp_img_dir: "/tmp/"

imports:
    - { resource: config_dev.yml }

framework:
    test: ~
    session:
        storage_id: session.storage.mock_file
    profiler:
        collect: false

web_profiler:
    toolbar: '%use_debug_toolbar%'
    intercept_redirects: true

swiftmailer:
    disable_delivery: true

services:
    prestashop.bundle.routing.converter.cache:
        class: Symfony\Component\Cache\Adapter\ArrayAdapter

    prestashop.adapter.image.uploader.category_cover_image_uploader:
      class: 'PrestaShop\PrestaShop\Adapter\Image\Uploader\CategoryCoverImageUploader'
      arguments:
        - '%ps_tmp_img_dir%'

    prestashop.adapter.category.command_handler.edit_category_handler:
      class: PrestaShop\PrestaShop\Adapter\Category\CommandHandler\EditCategoryHandler
      arguments:
        - '%ps_tmp_img_dir%'
      public: true
      tags:
        - { name: tactician.handler, command: PrestaShop\PrestaShop\Core\Domain\Category\Command\EditCategoryCommand }

    prestashop.adapter.category.query_handler.get_category_for_editing:
      class: PrestaShop\PrestaShop\Adapter\Category\QueryHandler\GetCategoryForEditingHandler
      arguments:
        - '@prestashop.core.image.parser.image_tag_source_parser'
        - '%ps_tmp_img_dir%'
      tags:
        - { name: tactician.handler, command: PrestaShop\PrestaShop\Core\Domain\Category\Query\GetCategoryForEditing }

    prestashop.adapter.category.command_handler.delete_category_menu_thumbnail_image_handler:
      class: PrestaShop\PrestaShop\Adapter\Category\CommandHandler\DeleteCategoryMenuThumbnailImageHandler
      arguments:
        - '@filesystem'
        - '@prestashop.adapter.legacy.configuration'
        - '@prestashop.adapter.cache.clearer.smarty_cache_clearer'
        - '%ps_tmp_img_dir%'
      tags:
        - name: tactician.handler
          command: PrestaShop\PrestaShop\Core\Domain\Category\Command\DeleteCategoryMenuThumbnailImageCommand

# Doctrine Configuration
doctrine:
    dbal:
        connections:
            default:
                dbname: "test_%database_name%"
