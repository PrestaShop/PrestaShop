parameters:
    prestashop.security.voter.product.class: PrestaShopBundle\Security\Voter\PageVoter

services:
    _defaults:
        public: true

    prestashop.security.admin.provider:
        class: PrestaShopBundle\Security\Admin\EmployeeProvider
        arguments:
            - "@prestashop.adapter.legacy.context"
            - "@prestashop.static_cache.adapter"

    prestashop.security.admin.user_provider:
      class: PrestaShopBundle\Security\Admin\UserProvider
      arguments:
        - "@prestashop.adapter.legacy.context"
        - "@prestashop.static_cache.adapter"
        - "@prestashop.core.query_bus"
        - "@prestashop.core.cache.employee_cache_key_generator"

    prestashop.security.admin.login_form_authenticator:
        class: PrestaShopBundle\Security\Admin\LoginFormAuthenticator
        arguments:
            - "@prestashop.core.crypto.hashing"
            - "@prestashop.router"
            - "@prestashop.core.query_bus"
            - "@prestashop.adapter.legacy.logger"
            - "@translator"
            - "@form.factory"
            - "@prestashop.adapter.security.employee_authentication_handler"

    prestashop.security.role.dynamic_role_hierarchy:
        class: PrestaShopBundle\Security\Role\DynamicRoleHierarchy

    prestashop.security.voter.product:
        class: "%prestashop.security.voter.product.class%"
        tags:
            - { name: security.voter }
        public: false
