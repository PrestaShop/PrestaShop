services:
  _defaults:
    public: true

  prestashop.adapter.security.employee_authentication_handler:
    class: PrestaShop\PrestaShop\Adapter\Security\EmployeeAuthenticationHandler
    arguments:
      - '@prestashop.adapter.legacy.context'
      - '@security.token_storage'
      - '@prestashop.security.admin.user_provider'
      - '@prestashop.static_cache.adapter'
      - '@request_stack'
      - '@prestashop.core.cache.employee_cache_key_generator'

  prestashop.adapter.security.employee_logout_handler:
    class: PrestaShop\PrestaShop\Adapter\Security\EmployeeLogoutHandler
    arguments:
      - '@prestashop.adapter.legacy.context'

  prestashop.adapter.security.secure_mode_checker:
    class: PrestaShop\PrestaShop\Adapter\Security\SecureModeChecker
    arguments:
      - '@prestashop.adapter.legacy.configuration'
      - '@prestashop.adapter.tools'

  prestashop.adapter.security.backoffice_access_prerequisites_checker:
    class: PrestaShop\PrestaShop\Adapter\Security\BackOfficeAccessPrerequisitesChecker
    arguments:
      - '@prestashop.adapter.legacy.configuration'
      - '@filesystem'

  prestashop.adapter.security.admin_directory_renamer:
    class: PrestaShop\PrestaShop\Adapter\Security\AdminDirectoryRenamer
    arguments:
      - '@prestashop.adapter.tools'
      - '@prestashop.adapter.legacy.configuration'
      - '@filesystem'
