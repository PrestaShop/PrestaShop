{#**
 * Copyright since 2007 PrestaShop SA and Contributors
 * PrestaShop is an International Registered Trademark & Property of PrestaShop SA
 *
 * NOTICE OF LICENSE
 *
 * This source file is subject to the Open Software License (OSL 3.0)
 * that is bundled with this package in the file LICENSE.md.
 * It is also available through the world-wide-web at this URL:
 * https://opensource.org/licenses/OSL-3.0
 * If you did not receive a copy of the license and are unable to
 * obtain it through the world-wide-web, please send an email
 * to license@prestashop.com so we can send you a copy immediately.
 *
 * DISCLAIMER
 *
 * Do not edit or add to this file if you wish to upgrade PrestaShop to newer
 * versions in the future. If you wish to customize PrestaShop for your
 * needs please refer to https://devdocs.prestashop.com/ for more information.
 *
 * @author    PrestaShop SA and Contributors <contact@prestashop.com>
 * @copyright Since 2007 PrestaShop SA and Contributors
 * @license   https://opensource.org/licenses/OSL-3.0 Open Software License (OSL 3.0)
 *#}

{% set passwordMinLength = constant('PrestaShop\\PrestaShop\\Core\\Domain\\Employee\\ValueObject\\Password::MIN_LENGTH') %}
{% set passwordHelpMessage = 'Password should be at least %num% characters long.'|trans({ '%num%': passwordMinLength }, 'Admin.Advparameters.Help') %}
{% set oldPasswordVars = change_password.old_password.vars|merge(old_password|default({})) %}
{% set newPasswordFirstVars = change_password.new_password.children.first.vars|merge(new_password.first_options|default({})) %}
{% set newPasswordSecondVars = change_password.new_password.children.second.vars|merge(new_password.second_options|default({})) %}
<div class="form-group row">
  <label class="form-control-label">
    {{ 'Password'|trans({}, 'Admin.Global') }}
  </label>
  <div class="col-sm">
    {# "Change password" button #}
    {{ form_widget(change_password.change_password_button, {
      label: 'Change password...'|trans({}, 'Admin.Actions'),
      attr: {
        class: 'btn-outline-secondary js-change-password',
      }
    }) }}

    <div class="card card-body js-change-password-block d-none">
      {# Current password input #}
      {{ ps.form_group_row(change_password.old_password, oldPasswordVars, {
        label: 'Current password'|trans({}, 'Admin.Advparameters.Feature'),
        required: true,
      }) }}

      {# New password first input #}
      <div class="form-group row">
        {{ ps.label_with_help('New password'|trans({}, 'Admin.Advparameters.Feature'), passwordHelpMessage, 'HII', change_password.new_password.children.first.vars.id, true) }}
        <div class="col-sm">
          {{ ps.form_widget_with_error(change_password.new_password.children.first, change_password.new_password.children.first.vars) }}
          {# Needed to render the text container for validation feedback messages. #}
          <small class="form-text text-danger"></small>
        </div>
      </div>

      {# New password second input (confirmation) #}
      {# Help text needed to render the text container for validation feedback messages.
      Because in help field won't be rendered if empty help here has a single space.  #}
      {{ ps.form_group_row(change_password.new_password.children.second, newPasswordSecondVars, {
        label: 'Confirm password'|trans({}, 'Admin.Advparameters.Feature'),
        help: ' ',
        required: true,
      }) }}

      <div class="form-group row">
        <label class="form-control-label"></label>
        <div class="col-sm">
          {{ form_widget(change_password.generated_password) }}
        </div>
        <div class="col-sm">
          {{ form_widget(change_password.generate_password_button, {
            label: 'Generate password'|trans({}, 'Admin.Actions'),
            attr: {
              class: 'btn-outline-secondary',
            }
          }) }}
        </div>
      </div>

      {{ ps.form_group_row(change_password.cancel_button, {
        label: 'Cancel'|trans({}, 'Admin.Actions'),
        attr: {
          class: 'btn-outline-secondary js-change-password-cancel',
        }
      }) }}

      {# Password strength feedback messages - used in JS #}
      <div class="js-password-strength-feedback d-none">
        <span class="strength-low">{{ 'Invalid'|trans({}, 'Admin.Advparameters.Help') }}</span>
        <span class="strength-medium">{{ 'Okay'|trans({}, 'Admin.Advparameters.Help') }}</span>
        <span class="strength-high">{{ 'Good'|trans({}, 'Admin.Advparameters.Help') }}</span>
        <span class="strength-extreme">{{ 'Fabulous'|trans({}, 'Admin.Advparameters.Help') }}</span>
      </div>
    </div>
  </div>
</div>
