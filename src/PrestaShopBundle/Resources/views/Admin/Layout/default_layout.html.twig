{#**
 * Copyright since 2007 PrestaShop SA and Contributors
 * PrestaShop is an International Registered Trademark & Property of PrestaShop SA
 *
 * NOTICE OF LICENSE
 *
 * This source file is subject to the Open Software License (OSL 3.0)
 * that is bundled with this package in the file LICENSE.md.
 * It is also available through the world-wide-web at this URL:
 * https://opensource.org/licenses/OSL-3.0
 * If you did not receive a copy of the license and are unable to
 * obtain it through the world-wide-web, please send an email
 * to license@prestashop.com so we can send you a copy immediately.
 *
 * DISCLAIMER
 *
 * Do not edit or add to this file if you wish to upgrade PrestaShop to newer
 * versions in the future. If you wish to customize PrestaShop for your
 * needs please refer to https://devdocs.prestashop.com/ for more information.
 *
 * @author    PrestaShop SA and Contributors <contact@prestashop.com>
 * @copyright Since 2007 PrestaShop SA and Contributors
 * @license   https://opensource.org/licenses/OSL-3.0 Open Software License (OSL 3.0)
 *#}
<!DOCTYPE html>
<html lang="{{ iso_user }}">
<head>
  {% block header %}
    {{ include('@PrestaShop/Admin/Layout/header.html.twig') }}
    {% block stylesheets %}{% endblock %}
    {% block extra_stylesheets %}{% endblock %}
  {% endblock %}
</head>

{# Should be handled somewhere else and set as global variable, the twig function won't be useful anymore then #}
{% set js_router_metadata = js_router_metadata() %}
<body
  class="lang-{{ iso_user }}{% if lang_is_rtl %} lang-rtl{% endif %} {{ controller_name|escape|lower }}{% if collapse_menu %} page-sidebar-closed{% endif %}{% if is_multishop|default(false) %} multishop-enabled{% endif %}{% if lite_display|default(false) %} light_display_layout{% endif %}{% if debug_mode|default(false) %} developer-mode{% endif %}"
  {% if js_router_metadata is defined and js_router_metadata.base_url is defined %}data-base-url="{{ js_router_metadata.base_url }}"{% endif %}
  {% if js_router_metadata is defined and js_router_metadata.token %}data-token="{{ js_router_metadata.token }}"{% endif %}
>

{# Layout header #}
{% if display_header %}
  {% block layout_header %}
    <header id="header" class="d-print-none">
      <nav id="header_infos" class="main-header">
        <button class="btn btn-primary-reverse onclick btn-lg unbind ajax-spinner"></button>

        {# Logo #}
        <i class="material-icons js-mobile-menu">menu</i>
        <a id="header_logo" class="logo float-left" href="{{ default_tab_link }}"></a>
        <span id="shop_version">{{ ps_version }}</span>

        <div class="component" id="quick-access-container">
          {{ render(controller('PrestaShopBundle\\Controller\\Admin\\LegacyController::smartyComponentAction', {
            'smartyTemplate': 'components/layout/quick_access.tpl',
            'smartyVariables': {
              'quick_access': quick_access,
              'quick_access_current_link_icon': quick_access_current_link_icon,
              'quick_access_current_link_name': quick_access_current_link_name,
              'link': link,
            }
          })) }}
        </div>
        <div class="component component-search" id="header-search-container">
          <div class="component-search-body">
            <div class="component-search-top">
              {{ render(controller('PrestaShopBundle\\Controller\\Admin\\LegacyController::smartyComponentAction', {
                'smartyTemplate': 'components/layout/search_form.tpl',
                'smartyVariables': {
                  'baseAdminUrl': baseAdminUrl,
                  'bo_query': bo_query,
                }
              })) }}
              <button class="component-search-cancel d-none">
                {{ 'Cancel'|trans({}, 'Admin.Actions') }}
              </button>
            </div>

            {# Include quick access component based on components/layout/mobile_quickaccess.tpl #}
            {{ render(controller('PrestaShopBundle\\Controller\\Admin\\LegacyController::smartyComponentAction', {
              'smartyTemplate': 'components/layout/mobile_quickaccess.tpl',
              'smartyVariables': {
                'quick_access': quick_access,
                'quick_access_current_link_icon': quick_access_current_link_icon,
                'quick_access_current_link_name': quick_access_current_link_name,
                'link': link,
              }
            })) }}
          </div>

          <div class="component-search-background d-none"></div>
        </div>

        {% if debug_mode|default(false) %}
          <div class="component hide-mobile-sm" id="header-debug-mode-container">
            <a class="link shop-state"
               id="debug-mode"
               data-toggle="pstooltip"
               data-placement="bottom"
               data-html="true"
               title="<p class=&quot;text-left&quot;><strong>{{ 'Your shop is in debug mode.'|trans({}, 'Admin.Navigation.Notification') }}</strong></p><p class=&quot;text-left&quot;>{{ 'All the PHP errors and messages are displayed. When you no longer need it, [1]turn off[/1] this mode.'|trans({'[1]': '<strong>', '[/1]': '</strong>'}, 'Admin.Navigation.Notification') }}</p>"
               href="{{ url('admin_performance') }}"
            >
              <i class="material-icons">bug_report</i>
              <span>{{ 'Debug mode'|trans({}, 'Admin.Navigation.Header') }}</span>
            </a>
          </div>
        {% endif %}

        {% if maintenance_mode|default(false) %}
          {% set maintenanceTitle %}
            <p class="text-left text-nowrap">
              <strong>
                {{ 'Your store is in maintenance mode.'|trans({}, 'Admin.Navigation.Notification') }}
              </strong>
            </p>
            <p class="text-left">
              {{ 'Your visitors and customers cannot access your store while in maintenance mode.'|trans({}, 'Admin.Navigation.Notification') }}
            </p>
            <p class="text-left">
              {{ 'To manage the maintenance settings, go to Shop Parameters > Maintenance tab.'|trans({}, 'Admin.Navigation.Notification') }}
            </p>
            {% if maintenance_allow_admins|default(false) %}
              <p class="text-left">
                {{ 'Admins can access the store front office without storing their IP.'|trans({}, 'Admin.Navigation.Notification') }}
              </p>
            {% endif %}
          {% endset %}
          <div class="component hide-mobile-sm" id="header-maintenance-mode-container">
            <a class="link shop-state"
               id="maintenance-mode"
               data-toggle="pstooltip"
               data-placement="bottom"
               data-html="true"
               title="{{ maintenanceTitle|e('html') }}"
               href="{{ url('admin_maintenance') }}"
            >
              <i class="material-icons"
                 style="{% if maintenance_allow_admins|default(false) %}color: var(--green);{% endif %}"
              >build</i>
              <span>{{ 'Maintenance mode'|trans({}, 'Admin.Navigation.Header') }}</span>
            </a>
          </div>
        {% endif %}

        <div class="header-right">
          {% if hideLegacyStoreContextSelector is not defined or not hideLegacyStoreContextSelector %}
            <div class="component" id="header-shop-list-container">
              {{ render(controller('PrestaShopBundle\\Controller\\Admin\\LegacyController::smartyComponentAction', {
                'smartyTemplate': 'components/layout/shop_list.tpl',
                'smartyVariables': {
                  'base_url': base_url,
                  'is_multishop': is_multishop,
                  'shop_list': shop_list,
                  'multishop_context': multishop_context,
                  'current_shop_name': current_shop_name,
                }
              })) }}
            </div>
          {% endif %}
          {% if show_new_orders or show_new_customers or show_new_messages %}
            <div class="component header-right-component" id="header-notifications-container">
              {{ render(controller('PrestaShopBundle\\Controller\\Admin\\LegacyController::smartyComponentAction', {
                'smartyTemplate': 'components/layout/notifications_center.tpl',
                'smartyVariables': {
                  'show_new_orders': show_new_orders,
                  'show_new_customers': show_new_customers,
                  'show_new_messages': show_new_messages,
                  'no_order_tip': no_order_tip,
                  'no_customer_tip': no_customer_tip,
                  'no_customer_message_tip': no_customer_message_tip,
                }
              })) }}
            </div>
          {% endif %}

          <div class="component" id="header-employee-container">
            {{ render(controller('PrestaShopBundle\\Controller\\Admin\\LegacyController::smartyComponentAction', {
              'smartyTemplate': 'components/layout/employee_dropdown.tpl',
              'smartyVariables': {
                'employee': employee,
                'link': link,
                'displayBackOfficeEmployeeMenu': displayBackOfficeEmployeeMenu,
                'logout_link': logout_link,
              }
            })) }}
          </div>
          {% if displayBackOfficeTop is defined %}
            {{ displayBackOfficeTop }}
          {% endif %}
        </div>
      </nav>
    </header>

    {{ render(controller('PrestaShopBundle\\Controller\\Admin\\LegacyController::smartyComponentAction', {
      'smartyTemplate': 'components/layout/nav_bar.tpl',
      'smartyVariables': {
        'toggle_navigation_url': toggle_navigation_url,
        'default_tab_link': default_tab_link,
        'ps_version': ps_version,
        'collapse_menu': collapse_menu,
        'tabs': tabs,
      }
    })) }}
  {% endblock %}
{% endif %}

{# Page header toolbar #}
{% if showContentHeader and not liteDisplay %}
  {{ include('@PrestaShop/Admin/Layout/page_header_toolbar.html.twig') }}
{% endif %}

<div id="main-div">
  {% if install_dir_exists|default(false) %}
    <div class="alert alert-warning">
      {{ 'For security reasons, you must also delete the /install folder.'|trans({}, 'Admin.Login.Notification') }}
    </div>
  {% else %}
    {% if modal_module_list is defined %}
      {{ modal_module_list }}
    {% endif %}

    <div
      class="{% if display_header %}content-div{% endif %}{% if page_header_toolbar is not defined %} -notoolbar{% endif %}{% if current_tab_level == 3 %} with-tabs{% endif %}">
      {{ renderhook('displayAdminAfterHeader', {}) }}

      {% if display_header %}
        {{ render(controller('PrestaShopBundle\\Controller\\Admin\\LegacyController::smartyComponentAction', {
          'smartyTemplate': 'components/layout/error_messages.tpl',
          'smartyVariables': {
            'errors': errors|default([]),
            'disableDefaultErrorOutPut': disableDefaultErrorOutPut|default(false),
          }
        })) }}
        {{ render(controller('PrestaShopBundle\\Controller\\Admin\\LegacyController::smartyComponentAction', {
          'smartyTemplate': 'components/layout/information_messages.tpl',
          'smartyVariables': {
            'informations': informations|default([]),
          }
        })) }}
        {{ render(controller('PrestaShopBundle\\Controller\\Admin\\LegacyController::smartyComponentAction', {
          'smartyTemplate': 'components/layout/confirmation_messages.tpl',
          'smartyVariables': {
            'confirmations': confirmations|default([]),
          }
        })) }}
        {{ render(controller('PrestaShopBundle\\Controller\\Admin\\LegacyController::smartyComponentAction', {
          'smartyTemplate': 'components/layout/warning_messages.tpl',
          'smartyVariables': {
            'warnings': warnings|default([]),
          }
        })) }}
      {% endif %}

      <div id="ajax_confirmation" class="alert alert-success" style="display: none;"></div>
      <div id="content-message-box"></div>

      {# Page content blocks #}
      {% block content_header %}{% endblock %}
      {% block content %}{% endblock %}
      {% block content_footer %}{% endblock %}
      {% block sidebar_right %}{% endblock %}

      {{ renderhook('displayAdminEndContent', {}) }}
    </div>
  {% endif %}
</div>

{% if lite_display is not defined or lite_display is same as(false) %}
  {{ render(controller('PrestaShopBundle\\Controller\\Admin\\LegacyController::smartyComponentAction', {
    'smartyTemplate': 'components/layout/non-responsive.tpl',
    'smartyVariables': {
      'default_tab_link': default_tab_link,
    }
  })) }}
  <div class="mobile-layer"></div>

  {% if display_footer %}
    {{ render(controller('PrestaShopBundle\\Controller\\Admin\\LegacyController::smartyComponentAction', {'smartyTemplate': 'footer.tpl'})) }}
  {% endif %}
{% endif %}

{{ render(controller('PrestaShopBundle\\Controller\\Admin\\LegacyController::smartyComponentAction', {
  'smartyTemplate': 'error.tpl',
  'smartyVariables': {
    'php_errors': php_errors|default([])
  }
})) }}

{% if lite_display is not defined or lite_display is same as(false) %}
  {% if modals is defined %}
    {{ modals }}
  {% endif %}
{% endif %}

{# Javascript blocks #}
{% block javascripts %}{% endblock %}
{% block extra_javascripts %}{% endblock %}
{% block translate_javascripts %}{% endblock %}
</body>
</html>
