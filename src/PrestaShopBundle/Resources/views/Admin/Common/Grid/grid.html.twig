{#**
 * 2007-2018 PrestaShop
 *
 * NOTICE OF LICENSE
 *
 * This source file is subject to the Open Software License (OSL 3.0)
 * that is bundled with this package in the file LICENSE.txt.
 * It is also available through the world-wide-web at this URL:
 * https://opensource.org/licenses/OSL-3.0
 * If you did not receive a copy of the license and are unable to
 * obtain it through the world-wide-web, please send an email
 * to license@prestashop.com so we can send you a copy immediately.
 *
 * DISCLAIMER
 *
 * Do not edit or add to this file if you wish to upgrade PrestaShop to newer
 * versions in the future. If you wish to customize PrestaShop for your
 * needs please refer to http://www.prestashop.com for more information.
 *
 * @author    PrestaShop SA <contact@prestashop.com>
 * @copyright 2007-2018 PrestaShop SA
 * @license   https://opensource.org/licenses/OSL-3.0 Open Software License (OSL 3.0)
 * International Registered Trademark & Property of PrestaShop SA
 *#}

{% set filtersForm = gridView.filterForm %}
{% set areBulkActionsAvailable = gridView.bulkActionsAvailable %}

<div class="js-grid" id="{{ gridView.identifier }}_grid">
  {{ form_start(filtersForm) }}
  <table class="js-grid-table table" id="{{ gridView.identifier }}_table">
    <thead class="thead-default">
      <tr class="column-headers">
        {% if areBulkActionsAvailable %}
          <th scope="col">&nbsp;</th>
        {% endif %}

        {% for column in gridView.columns %}
          <th scope="col">
            {% if column.is_sortable %}
              {{ ps.sortable_column_header(column.name, column.identifier, '', '') }}
            {% else %}
              {{ column.name }}
            {% endif %}
          </th>
        {% endfor %}

        <th scope="col">&nbsp;</th>
      </tr>
      {% if filtersForm|length > 1 %}
        <tr class="column-filters">
          {% if areBulkActionsAvailable %}
            <th>
              <input type="checkbox"
                     title="{{ 'Select all'|trans({}, 'Admin.Actions') }}"
                     class="js-select-all-bulk-actions-checkbox"
              >
            </th>
          {% endif %}

          {% for column in gridView.columns %}
            <th>
              {% if column.is_filterable %}
                {{ form_widget(filtersForm[column.identifier]) }}
              {% else %}
                -
              {% endif %}
            </th>
          {% endfor %}

          <th class="text-right">
            <button type="submit" class="btn btn-primary">
              <i class="material-icons">search</i>{{ 'Search'|trans({}, 'Admin.Shopparameters.Feature') }}
            </button>
            {#<button class="btn btn-warning">#}
            {#<i class="material-icons">clear</i>{{ 'Reset'|trans({}, 'Admin.Actions') }}#}
            {#</button>#}
          </th>
        </tr>
      {% endif %}
    </thead>
    <tbody>
    {# If table has any rows then render those here #}
    {% if gridView.rows is not empty %}
      {% for row in gridView.rows %}
        <tr>
          {% if areBulkActionsAvailable %}
            <th>
              <input class="js-bulk-action-checkbox"
                     name="{{ gridView.identifier }}_bulk[]"
                     type="checkbox"
                     title=""
                     value=""
              >
            </th>
          {% endif %}

          {# Render row columns here #}
          {% for column in gridView.columns %}
            {% set content = row.data[column.identifier] %}

            {% if column.is_raw %}
              <td>{{ content|raw }}</td>
            {% else %}
              <td>{{ content }}</td>
            {% endif %}
          {% endfor %}

          {# If row has any actions then render those here #}
          {% set rowActions = row.actions %}
          {% if rowActions is not empty %}
            <td class="text-right">
              <div class="btn-group-action">
                <div class="btn-group">
                  <a href="{{ rowActions|first.url }}"
                     title="{{ rowActions|first.name }}"
                     class="btn tooltip-link"
                  >
                    <i class="material-icons">{{ rowActions|first.icon }}</i>
                  </a>

                  {# If there's more than one action, then render remaining actions here #}
                  {% if rowActions|length > 1 %}
                    <a class="btn btn-link dropdown-toggle dropdown-toggle-split"
                       data-toggle="dropdown"
                       aria-haspopup="true"
                       aria-expanded="false"
                    >
                    </a>

                    <div class="dropdown-menu dropdown-menu-right">
                      {% for rowAction in rowActions|slice(1) %}
                        <a class="dropdown-item" href="{{ rowAction.url }}">
                          <i class="material-icons">{{ rowAction.icon }}</i>
                          {{ rowAction.name }}
                        </a>
                      {% endfor %}
                    </div>
                  {% endif %}
                </div>
              </div>
            </td>
          {% endif %}
        </tr>
      {% endfor %}
    {% else %}
      <tr>
        <td colspan="{{ gridView.columns|length }}">
          <div class="text-center">
            <p><i class="material-icons">warning</i></p>
            <p>{{ 'No records found'|trans }}</p>
          </div>
        </td>
      </tr>
    {% endif %}
    </tbody>
  </table>
  {% if areBulkActionsAvailable %}
    <div>
      <div class="btn-group dropup bulk-catalog">
        <button id="product_bulk_menu" class="btn btn-outline-secondary dropdown-toggle js-bulk-actions-btn"
                data-toggle="dropdown"
                disabled
        >
          {{ 'Bulk actions'|trans({}, 'Admin.Global') }}
          <i class="icon-caret-up"></i>
        </button>

        <div class="dropdown-menu">
          {% for bulkAction in gridView.bulkActions %}
            <button id="{{ '%s_%s_bulk_action'|format(gridView.identifier, bulkAction.identifier) }}"
                    class="dropdown-item"
                    type="button"
            >
              {% if bulkAction.icon is not empty %}
                <i class="material-icons">{{ bulkAction.icon }}</i>
              {% endif %}
              {{ bulkAction.name }}
            </button>
          {% endfor %}
        </div>
      </div>
    </div>
  {% endif %}
  {{ form_end(filtersForm) }}
</div>
