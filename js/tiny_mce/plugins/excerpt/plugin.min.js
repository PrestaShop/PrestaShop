tinymce.PluginManager.add(
	"excerpt",
	function(e){

		var style="cursor: default;display: block;border: 0;width: 100%;height: 5px;background-color: #3ed2f0;margin: 15px 0;",
			a="mce-excerpt",
			t=e.getParam("excerpt_separator","<!-- excerpt -->"),
			n=new RegExp(t.replace(/[\?\.\*\[\]\(\)\{\}\+\^\$\:]/g,function(e){return"\\"+e}),"gi"),
			r='<img src="'+tinymce.Env.transparentSrc+'" class="'+a+' mceNonEditable" style="'+style+'" data-mce-resize="false"  />';
		e.addCommand("InsertExcerptRule",
			function(){
				//if already added excerpt -> cancel action
				if(-1 !== e.getContent().indexOf("<!-- excerpt -->")){
					alert('Please remove the short description sperator first');
					return;
				}
				e.insertContent("<p>"+r+"</p>");
			}),
			e.on("ResolveName", function(t){"IMG"==t.target.nodeName&&e.dom.hasClass(t.target,a)&&(t.name="excerpt")}),
			e.on("click",function(t){t=t.target,"IMG"===t.nodeName&&e.dom.hasClass(t,a)&&e.selection.select(t)}),
			e.on("PreInit",function(){e.serializer.addNodeFilter("img",function(a){for(var n,r,c=a.length;c--;)if(n=a[c],r=n.attr("class"),r&&-1!==r.indexOf("mce-excerpt")){var o=n.parent;if(e.schema.getBlockElements()[o.name]&&e.settings.pagebreak_split_block){o.type=3,o.value=t,o.raw=!0,n.remove();continue}n.type=3,n.value=t,n.raw=!0}})}),
			e.on("BeforeSetContent",function(e){e.content=e.content.replace(n,r)}),
			e.addButton("excerpt",{
				icon:"cut",
				tooltip:"Add short description separator",
				cmd:"InsertExcerptRule"
			}),
			e.addMenuItem(
				"excerpt",{
					icon:"cut",
					text:"Add short description separator",
					cmd:"InsertExcerptRule",
					context:"insert"
				}
			)
	}
);






/*
tinymce.PluginManager.add("pagebreak", function(e){
	var a="mce-pagebreak",
		t=e.getParam("pagebreak_separator","<!-- pagebreak -->"),
		n=new RegExp(t.replace(/[\?\.\*\[\]\(\)\{\}\+\^\$\:]/g,function(e){return"\\"+e}),"gi"),
		r='<img src="'+tinymce.Env.transparentSrc+'" class="'+a+'" data-mce-resize="false" />';

	e.addCommand("mcePageBreak",function(){
		e.settings.pagebreak_split_block?e.insertContent("<p>"+r+"</p>"):e.insertContent(r)
	}),
		e.addButton("pagebreak",{title:"Page break",cmd:"mcePageBreak"}),
		e.addMenuItem("pagebreak",{text:"Page break",icon:"pagebreak",cmd:"mcePageBreak",context:"insert"}),
		e.on("ResolveName", function(t){"IMG"==t.target.nodeName&&e.dom.hasClass(t.target,a)&&(t.name="pagebreak")}),
		e.on("click",function(t){t=t.target,"IMG"===t.nodeName&&e.dom.hasClass(t,a)&&e.selection.select(t)}),
		e.on("BeforeSetContent",function(e){e.content=e.content.replace(n,r)}),
		e.on("PreInit",function(){e.serializer.addNodeFilter("img",function(a){for(var n,r,c=a.length;c--;)if(n=a[c],r=n.attr("class"),r&&-1!==r.indexOf("mce-pagebreak")){var o=n.parent;if(e.schema.getBlockElements()[o.name]&&e.settings.pagebreak_split_block){o.type=3,o.value=t,o.raw=!0,n.remove();continue}n.type=3,n.value=t,n.raw=!0}})})});
	*/