window.order_create=function(e){function t(o){if(r[o])return r[o].exports;var a=r[o]={i:o,l:!1,exports:{}};return e[o].call(a.exports,a,a.exports,t),a.l=!0,a.exports}var r={};return t.m=e,t.c=r,t.i=function(e){return e},t.d=function(e,r,o){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:o})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=344)}({264:function(e,t,r){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,r,o){return r&&e(t.prototype,r),o&&e(t,o),t}}(),s=r(61),u=o(s),i=r(346),d=o(i),c=r(349),l=o(c),f=r(345),m=o(f),h=window.$,p=function(){function e(){var t=this;return a(this,e),this.data={},this.$container=h(u.default.orderCreationContainer),this.customerSearcher=new d.default,this.shippingRenderer=new l.default,this.orderProducts=new m.default,{listenForCustomerSearch:function(){return t._handleCustomerSearch()},listenForCustomerChooseForOrderCreation:function(){return t._handleCustomerChooseForOrderCreation()}}}return n(e,[{key:"_handleCustomerSearch",value:function(){var e=this;this.$container.on("input",u.default.customerSearchInput,function(){e.customerSearcher.onCustomerSearch()})}},{key:"_handleCustomerChooseForOrderCreation",value:function(){var e=this;this.$container.on("click",u.default.chooseCustomerBtn,function(t){e.data.customer_id=e.customerSearcher.onCustomerChooseForOrderCreation(t),e._loadCartSummaryAfterChoosingCustomer()}),this.$container.on("click",u.default.changeCustomerBtn,function(){return e.customerSearcher.onCustomerChange()}),this.$container.on("change",u.default.addressSelect,function(){return e._changeCartAddresses()}),this.$container.on("click",".js-use-cart-btn",function(){var t=h(event.target).data("cart-id");e._choosePreviousCart(t)})}},{key:"_loadCartSummaryAfterChoosingCustomer",value:function(){var e=this;h.ajax(this.$container.data("last-empty-cart-url"),{method:"POST",data:{id_customer:this.data.customer_id},dataType:"json"}).then(function(t){e.data.cart_id=t.cart.id_cart;var r={carts:void 0!==t.carts?t.carts:[],orders:void 0!==t.orders?t.orders:[]};e._renderCheckoutHistory(r),e._renderCartSummary(t)})}},{key:"_renderCheckoutHistory",value:function(e){this._renderCustomerCarts(e.carts),this._renderCustomerOrders(e.orders),h(u.default.customerCheckoutHistory).removeClass("d-none")}},{key:"_renderCustomerCarts",value:function(e){var t=h(u.default.customerCartsTable),r=h(h(u.default.customerCartsTableRowTemplate).html());if(t.find("tbody").empty(),e){for(var o in e)if(e.hasOwnProperty(o)){var a=e[o],n=r.clone();n.find(".js-cart-id").text(a.id_cart),n.find(".js-cart-date").text(a.date_add),n.find(".js-cart-total").text(a.total_price),n.find(".js-use-cart-btn").data("cart-id",a.id_cart),t.find("tbody").append(n)}h(u.default.customerCheckoutHistory).removeClass("d-none")}}},{key:"_renderCartSummary",value:function(e){this._renderAddressesSelect(e),this._showCartSummary()}},{key:"_renderCustomerOrders",value:function(e){var t=h(u.default.customerOrdersTable),r=h(h(u.default.customerOrdersTableRowTemplate).html());if(t.find("tbody").empty(),e)for(var o in Object.keys(e))if(e.hasOwnProperty(o)){var a=e[o],n=r.clone();n.find(".js-order-id").text(a.id_order),n.find(".js-order-date").text(a.date_add),n.find(".js-order-products").text(a.nb_products),n.find(".js-order-total-paid").text(a.total_paid_real),n.find(".js-order-status").text(a.order_state),t.find("tbody").append(n)}}},{key:"_showCartSummary",value:function(){h(u.default.cartBlock).removeClass("d-none"),h(u.default.vouchersBlock).removeClass("d-none"),h(u.default.addressesBlock).removeClass("d-none")}},{key:"_renderAddressesSelect",value:function(e){var t="",r="",o=h(u.default.deliveryAddressDetails),a=h(u.default.invoiceAddressDetails),n=h(u.default.deliveryAddressSelect),s=h(u.default.invoiceAddressSelect),i=h(u.default.addressesContent),d=h(u.default.addressesWarning);if(o.empty(),a.empty(),n.empty(),s.empty(),0===e.addresses.length)return d.removeClass("d-none"),void i.addClass("d-none");i.removeClass("d-none"),d.addClass("d-none");for(var c in Object.keys(e.addresses))if(e.addresses.hasOwnProperty(c)){var l=e.addresses[c],f={value:l.id_address,text:l.alias},m={value:l.id_address,text:l.alias};parseInt(e.cart.id_address_delivery)===parseInt(l.id_address)&&(t=l.formated_address,f.selected="selected"),parseInt(e.cart.id_address_invoice)===parseInt(l.id_address)&&(r=l.formated_address,m.selected="selected"),n.append(h("<option>",f)),s.append(h("<option>",m))}t&&h(u.default.deliveryAddressDetails).html(t),r&&h(u.default.invoiceAddressDetails).html(r)}},{key:"_changeCartAddresses",value:function(){var e=this;h.ajax(this.$container.data("cart-addresses-url"),{data:{id_customer:this.data.customer_id,id_cart:this.data.cart_id,id_address_delivery:h(u.default.deliveryAddressSelect).val(),id_address_invoice:h(u.default.invoiceAddressSelect).val()},dataType:"json"}).then(function(t){e._persistCartSummaryData(t),e._renderAddressesSelect(t)})}},{key:"_persistCartSummaryData",value:function(e){this.data.cart_id=e.cart.id,this.data.delivery_address_id=e.cart.id_address_delivery,this.data.invoice_address_id=e.cart.id_address_invoice}},{key:"_choosePreviousCart",value:function(e){var t=this;h.ajax(this.$container.data("cart-summary-url"),{method:"POST",data:{id_cart:e,id_customer:this.data.customer_id},dataType:"json"}).then(function(e){t._persistCartSummaryData(e),t._renderCartSummary(e)})}}]),e}();t.default=p},344:function(e,t,r){"use strict";var o=r(264),a=function(e){return e&&e.__esModule?e:{default:e}}(o);/**
                   * 2007-2019 PrestaShop and Contributors
                   *
                   * NOTICE OF LICENSE
                   *
                   * This source file is subject to the Open Software License (OSL 3.0)
                   * that is bundled with this package in the file LICENSE.txt.
                   * It is also available through the world-wide-web at this URL:
                   * https://opensource.org/licenses/OSL-3.0
                   * If you did not receive a copy of the license and are unable to
                   * obtain it through the world-wide-web, please send an email
                   * to license@prestashop.com so we can send you a copy immediately.
                   *
                   * DISCLAIMER
                   *
                   * Do not edit or add to this file if you wish to upgrade PrestaShop to newer
                   * versions in the future. If you wish to customize PrestaShop for your
                   * needs please refer to https://www.prestashop.com for more information.
                   *
                   * @author    PrestaShop SA <contact@prestashop.com>
                   * @copyright 2007-2019 PrestaShop SA and Contributors
                   * @license   https://opensource.org/licenses/OSL-3.0 Open Software License (OSL 3.0)
                   * International Registered Trademark & Property of PrestaShop SA
                   */
(0,window.$)(document).ready(function(){var e=new a.default;e.listenForCustomerSearch(),e.listenForCustomerChooseForOrderCreation()})},345:function(e,t,r){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){var r=[],o=!0,a=!1,n=void 0;try{for(var s,u=e[Symbol.iterator]();!(o=(s=u.next()).done)&&(r.push(s.value),!t||r.length!==t);o=!0);}catch(e){a=!0,n=e}finally{try{!o&&u.return&&u.return()}finally{if(a)throw n}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),n=function(){function e(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,r,o){return r&&e(t.prototype,r),o&&e(t,o),t}}(),s=r(61),u=function(e){return e&&e.__esModule?e:{default:e}}(s),i=window.$,d=function(){function e(){return o(this,e),this.products=[],this.combinations=[],this._initEvents(),{}}return n(e,[{key:"_initEvents",value:function(){var e=this;i(u.default.productSearch).on("input",function(t){return e._handleProductSearch(t)}),i(u.default.productSelect).on("change",function(t){return e._handleProductChange(t)})}},{key:"_handleProductSearch",value:function(e){var t=this,r=i(e.target).val();r.length<3||i.ajax(i(e.target).data("url"),{method:"GET",data:{product_search_phrase:r}}).then(function(e){t.products=JSON.parse(e),t._renderProductSearchResult()}).catch(function(e){404===e.status&&(t._showNotFoundProducts(),t.products=[]),void 0!==e.responseJSON&&showErrorMessage(e.responseJSON.message)})}},{key:"_renderProductSearchResult",value:function(){i(u.default.productSelect).empty();var e=!0,t=!1,r=void 0;try{for(var o,n=this.products.entries()[Symbol.iterator]();!(e=(o=n.next()).done);e=!0){var s=a(o.value,2),d=s[0],c=s[1];0===d&&this._fillRelatedProductFields(c);var l=c.name;null===c.combinations&&(l+=" - "+c.formatted_price),null===c.combinations&&0===d&&this._updateStock(c.stock),i(u.default.productSelect).append(i("<option></option>").attr("value",c.product_id).text(l).attr("data-index",d))}}catch(e){t=!0,r=e}finally{try{!e&&n.return&&n.return()}finally{if(t)throw r}}var f=i(u.default.noRecordsFound).find(u.default.noRecordsFoundRow);0!==f.length&&f.remove(),this._showResultBlock()}},{key:"_updateStock",value:function(e){i(u.default.inStockCounter).text(e),i(u.default.quantityInput).attr("max",e)}},{key:"_fillRelatedProductFields",value:function(e){this._fillCombinations(e.combinations),this._resolveCustomizationFields(e.customization_fields)}},{key:"_handleProductChange",value:function(e){var t=i(e.target).find(":selected").data("index"),r=this.products[t];this._fillRelatedProductFields(r),null===r.combinations&&(this.combinations=[],this._updateStock(r.stock)),this._fillCombinations(r.combinations)}},{key:"_handleCombinationChange",value:function(e){var t=i(e.target).find(":selected").data("index"),r=this.combinations[t];this._updateStock(r.stock)}},{key:"_fillCombinations",value:function(e){var t=this;if(null===e)return void this._removeCombinationSelect();if(this.combinations=e.combinations,0===i(u.default.combinationsRow).length){var r=i(i(u.default.combinationsTemplate).html());i(u.default.productSelectRow).after(r)}i(u.default.combinationsSelect).empty();var o=Object.entries(e.combinations),n=0,s=!0,d=!1,c=void 0;try{for(var l,f=o[Symbol.iterator]();!(s=(l=f.next()).done);s=!0){var m=a(l.value,2),h=m[0],p=m[1];0===n&&this._updateStock(p.stock);var v=p.attribute+" - "+p.formatted_price;i(u.default.combinationsSelect).append(i("<option></option>").attr("value",h).text(v)),n+=1}}catch(e){d=!0,c=e}finally{try{!s&&f.return&&f.return()}finally{if(d)throw c}}i(u.default.combinationsSelect).on("change",function(e){return t._handleCombinationChange(e)})}},{key:"_resolveCustomizationFields",value:function(e){if(this._removeCustomizedFields(),null!==e){var t=i(u.default.cartProductCustomizedFieldTemplate),r=i(t.html()),o=i(u.default.productSelect).data("customization-label");r.find(u.default.customizedLabelClass).text(o),i(u.default.quantityRow).before(r),i.each(e.product_customization_fields,function(e,o){var a=i(i(u.default.customizedFieldTypes[o.type]).html());r=i(t.html()),o.required&&r.find(u.default.customizedLabelClass).append('<span class="text-danger">*</span>'),r.find(u.default.customizedLabelClass).append(o.name),r.find(u.default.customizedFieldInputWrapper).append(a),i(u.default.quantityRow).before(r)})}}},{key:"_removeCombinationSelect",value:function(){i(u.default.combinationsRow).remove()}},{key:"_removeCustomizedFields",value:function(){i(u.default.customizedFieldContainer).remove()}},{key:"_showNotFoundProducts",value:function(){var e=i(i("#productSearchEmptyResultTemplate").html());this._hideResultBlock();var t=i(u.default.noRecordsFound);0===t.find(u.default.noRecordsFoundRow).length&&t.append(e)}},{key:"_showResultBlock",value:function(){i(u.default.productResultBlock).show(),i(u.default.productResultBlock).removeClass("d-none")}},{key:"_hideResultBlock",value:function(){i(u.default.productResultBlock).hide()}}]),e}();t.default=d},346:function(e,t,r){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,r,o){return r&&e(t.prototype,r),o&&e(t,o),t}}(),n=r(61),s=function(e){return e&&e.__esModule?e:{default:e}}(n),u=window.$,i=function(){function e(){var t=this;return o(this,e),this.$container=u(s.default.customerSearchBlock),this.$searchInput=u(s.default.customerSearchInput),this.$customerSearchResultBlock=u(s.default.customerSearchResultsBlock),{onCustomerSearch:function(){t._doSearch()},onCustomerChooseForOrderCreation:function(e){return t._chooseCustomerForOrderCreation(e)},onCustomerChange:function(){t._showCustomerSearch()}}}return a(e,[{key:"_chooseCustomerForOrderCreation",value:function(e){var t=u(e.currentTarget),r=t.closest(".card");return t.addClass("d-none"),r.addClass("border-success"),r.find(s.default.changeCustomerBtn).removeClass("d-none"),this.$container.find(s.default.customerSearchRow).addClass("d-none"),this.$container.find(s.default.notSelectedCustomerSearchResults).closest(s.default.customerSearchResultColumn).remove(),t.data("customer-id")}},{key:"_doSearch",value:function(){var e=this,t=this.$searchInput.val();t.length<4||u.ajax(this.$searchInput.data("url"),{method:"GET",data:{customer_search:t}}).then(function(t){if(e._clearShownCustomers(),!t.found)return void e._showNotFoundCustomers();for(var r in t.customers){var o=t.customers[r],a={id:r,first_name:o.firstname,last_name:o.lastname,email:o.email,birthday:"0000-00-00"!==o.birthday?o.birthday:" "};e._showCustomer(a)}})}},{key:"_showCustomer",value:function(e){var t=u(u(s.default.customerSearchResultTemplate).html()),r=t.clone();return r.find(s.default.customerSearchResultName).text(e.first_name+" "+e.last_name),r.find(s.default.customerSearchResultEmail).text(e.email),r.find(s.default.customerSearchResultId).text(e.id),r.find(s.default.customerSearchResultBirthday).text(e.birthday),r.find(s.default.customerDetailsBtn).data("customer-id",e.id),r.find(s.default.chooseCustomerBtn).data("customer-id",e.id),this.$customerSearchResultBlock.append(r)}},{key:"_showNotFoundCustomers",value:function(){var e=u(u("#customerSearchEmptyResultTemplate").html());this.$customerSearchResultBlock.append(e)}},{key:"_clearShownCustomers",value:function(){this.$customerSearchResultBlock.empty()}},{key:"_showCustomerSearch",value:function(){this.$container.find(s.default.customerSearchRow).removeClass("d-none")}}]),e}();t.default=i},349:function(e,t,r){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,r,o){return r&&e(t.prototype,r),o&&e(t,o),t}}(),n=r(61),s=function(e){return e&&e.__esModule?e:{default:e}}(n),u=window.$,i=function(){function e(){o(this,e),this.$container=u(s.default.shippingBlock)}return a(e,[{key:"show",value:function(){this.$container.removeClass("d-none")}},{key:"hide",value:function(){this.$container.addClass("d-none")}}]),e}();t.default=i},61:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),/**
 * 2007-2019 PrestaShop and Contributors
 *
 * NOTICE OF LICENSE
 *
 * This source file is subject to the Open Software License (OSL 3.0)
 * that is bundled with this package in the file LICENSE.txt.
 * It is also available through the world-wide-web at this URL:
 * https://opensource.org/licenses/OSL-3.0
 * If you did not receive a copy of the license and are unable to
 * obtain it through the world-wide-web, please send an email
 * to license@prestashop.com so we can send you a copy immediately.
 *
 * DISCLAIMER
 *
 * Do not edit or add to this file if you wish to upgrade PrestaShop to newer
 * versions in the future. If you wish to customize PrestaShop for your
 * needs please refer to https://www.prestashop.com for more information.
 *
 * @author    PrestaShop SA <contact@prestashop.com>
 * @copyright 2007-2019 PrestaShop SA and Contributors
 * @license   https://opensource.org/licenses/OSL-3.0 Open Software License (OSL 3.0)
 * International Registered Trademark & Property of PrestaShop SA
 */
t.default={orderCreationContainer:"#orderCreationContainer",customerSearchInput:"#customerSearchInput",customerSearchResultsBlock:".js-customer-search-results",customerSearchResultTemplate:"#customerSearchResultTemplate",changeCustomerBtn:".js-change-customer-btn",customerSearchRow:".js-search-customer-row",chooseCustomerBtn:".js-choose-customer-btn",notSelectedCustomerSearchResults:".js-customer-search-result:not(.border-success)",customerSearchResultName:".js-customer-name",customerSearchResultEmail:".js-customer-email",customerSearchResultId:".js-customer-id",customerSearchResultBirthday:".js-customer-birthday",customerDetailsBtn:".js-details-customer-btn",customerSearchResultColumn:".js-customer-search-result-col",customerSearchBlock:"#customerSearchBlock",customerCartsTable:"#customerCartsTable",customerCartsTableRowTemplate:"#customerCartsTableRowTemplate",customerCheckoutHistory:"#customerCheckoutHistory",customerOrdersTable:"#customerOrdersTable",customerOrdersTableRowTemplate:"#customerOrdersTableRowTemplate",cartBlock:"#cartBlock",vouchersBlock:"#vouchersBlock",addressesBlock:"#addressesBlock",deliveryAddressDetails:"#deliveryAddressDetails",invoiceAddressDetails:"#invoiceAddressDetails",deliveryAddressSelect:"#deliveryAddressSelect",invoiceAddressSelect:"#invoiceAddressSelect",addressSelect:".js-address-select",addressesContent:"#addressesContent",addressesWarning:"#addressesWarning",summaryBlock:"#summaryBlock",shippingBlock:"#shippingBlock",productSearch:"#productSearch",combinationsSelect:"#combinationsSelect",productResultBlock:"#productSearchResults",productSelect:"#productSelect",quantityInput:"#quantityInput",noRecordsFound:".js-no-records-found",noRecordsFoundRow:".js-no-records-found-row",inStockCounter:".js-in-stock-counter",combinationsTemplate:"#combinationsTemplate",combinationsRow:".js-combinations-row",productSelectRow:".js-product-select-row",customizedFieldContainer:".js-customized-field-container",quantityRow:".js-quantity-row",customizedLabelClass:".js-customized-field-label",cartProductCustomizedFieldTemplate:"#cartProductCustomizedFieldTemplate",customizedFieldInputWrapper:".js-customized-field-input-wrapper",customizedFieldTypes:{0:"#cartProductCustomizedFieldInputTemplate-0",1:"#cartProductCustomizedFieldInputTemplate-1"}}}});
