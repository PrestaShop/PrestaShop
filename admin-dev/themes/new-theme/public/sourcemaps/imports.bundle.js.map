{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./js/pages/import/FormFieldToggle.js","webpack:///./js/pages/import/ImportPage.js","webpack:///./js/pages/import/index.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","$","window","entityCategories","entityProducts","entityCombinations","entityCustomers","entityAddresses","entityBrands","entitySuppliers","entityAlias","entityStoreContacts","FormFieldToggle","_this","this","_classCallCheck","on","toggleForm","selectedOption","find","selectedEntity","parseInt","val","entityName","text","toLowerCase","toggleEntityAlert","toggleFields","loadAvailableFields","$alert","includes","show","hide","$truncateFormGroup","$matchRefFormGroup","$regenerateFormGroup","$forceIdsFormGroup","$entityNamePlaceholder","html","entity","_this2","$availableFields","ajax","url","data","dataType","then","response","_removeAvailableFields","length","_appendAvailableField","label","required","description","popover","$container","empty","$field","helpBoxContent","$helpBox","clone","attr","removeClass","append","$appendTo","fieldText","_appendHelpBox","appendTo","ImportPage","ImportPage_classCallCheck","showFilesHistoryHandler","closeFilesHistoryHandler","event","useFileFromFilesHistory","changeImportFileHandler","uploadFile","toggleSelectedFile","handleSubmit","$this","confirm","concat","trim","selectFilename","showImportFileAlert","hideFileUploadBlock","hideImportFileAlert","showFileUploadBlock","showFilesHistory","closeFilesHistory","addClass","filename","target","closest","removeAttr","fileName","fileSize","message","fileData","humanizeSize","bytes","toFixed","hideImportFileError","$input","uploadedFile","prop","size","showImportFileError","FormData","type","cache","contentType","processData","error","file","addFileToHistoryTable","enableFilesHistoryBtn","$table","deleteUrl","encodeURIComponent","downloadUrl","$template","filesNumber"],"mappings":";QACA,IAAAA,EAAA,GAGA,SAAAC,EAAAC,GAGA,GAAAF,EAAAE,GACA,OAAAF,EAAAE,GAAAC,QAGA,IAAAC,EAAAJ,EAAAE,GAAA,CACAG,EAAAH,EACAI,GAAA,EACAH,QAAA,IAUA,OANAI,EAAAL,GAAAM,KAAAJ,EAAAD,QAAAC,IAAAD,QAAAF,GAGAG,EAAAE,GAAA,EAGAF,EAAAD,QAKAF,EAAAQ,EAAAF,EAGAN,EAAAS,EAAAV,EAGAC,EAAAU,EAAA,SAAAR,EAAAS,EAAAC,GACAZ,EAAAa,EAAAX,EAAAS,IACAG,OAAAC,eAAAb,EAAAS,EAAA,CAA0CK,YAAA,EAAAC,IAAAL,KAK1CZ,EAAAkB,EAAA,SAAAhB,GACA,oBAAAiB,eAAAC,aACAN,OAAAC,eAAAb,EAAAiB,OAAAC,YAAA,CAAwDC,MAAA,WAExDP,OAAAC,eAAAb,EAAA,cAAiDmB,OAAA,KAQjDrB,EAAAsB,EAAA,SAAAD,EAAAE,GAEA,GADA,EAAAA,IAAAF,EAAArB,EAAAqB,IACA,EAAAE,EAAA,OAAAF,EACA,KAAAE,GAAA,iBAAAF,QAAAG,WAAA,OAAAH,EACA,IAAAI,EAAAX,OAAAY,OAAA,MAGA,GAFA1B,EAAAkB,EAAAO,GACAX,OAAAC,eAAAU,EAAA,WAAyCT,YAAA,EAAAK,UACzC,EAAAE,GAAA,iBAAAF,EAAA,QAAAM,KAAAN,EAAArB,EAAAU,EAAAe,EAAAE,EAAA,SAAAA,GAAgH,OAAAN,EAAAM,IAAqBC,KAAA,KAAAD,IACrI,OAAAF,GAIAzB,EAAA6B,EAAA,SAAA1B,GACA,IAAAS,EAAAT,KAAAqB,WACA,WAA2B,OAAArB,EAAA,SAC3B,WAAiC,OAAAA,GAEjC,OADAH,EAAAU,EAAAE,EAAA,IAAAA,GACAA,GAIAZ,EAAAa,EAAA,SAAAiB,EAAAC,GAAsD,OAAAjB,OAAAkB,UAAAC,eAAA1B,KAAAuB,EAAAC,IAGtD/B,EAAAkC,EAAA,GAIAlC,IAAAmC,EAAA;;;;;;;;;;;;;;;;;;;;;;;;;ACzDA,IAAMC,EAAIC,OAAOD,EAEXE,EAAmB,EACnBC,EAAiB,EACjBC,EAAqB,EACrBC,EAAkB,EAClBC,EAAkB,EAClBC,EAAe,EACfC,EAAkB,EAClBC,EAAc,EACdC,EAAsB,EAEPC,aACnB,SAAAA,IAAc,IAAAC,EAAAC,kGAAAC,CAAAD,KAAAF,GACZX,EAAE,qBAAqBe,GAAG,SAAU,kBAAMH,EAAKI,eAE/CH,KAAKG,yEAIL,IAAIC,EAAiBjB,EAAE,WAAWkB,KAAK,mBACnCC,EAAiBC,SAASH,EAAeI,OACzCC,EAAaL,EAAeM,OAAOC,cAEvCX,KAAKY,kBAAkBN,GACvBN,KAAKa,aAAaP,EAAgBG,GAClCT,KAAKc,oBAAoBR,6CAQTA,GAChB,IAAIS,EAAS5B,EAAE,oBAEX,CAACE,EAAkBC,GAAgB0B,SAASV,GAC9CS,EAAOE,OAEPF,EAAOG,4CAUEZ,EAAgBG,GAC3B,IAAMU,EAAqBhC,EAAE,2BACvBiC,EAAqBjC,EAAE,4BACvBkC,EAAuBlC,EAAE,6BACzBmC,EAAqBnC,EAAE,4BACvBoC,EAAyBpC,EAAE,mBAE7BU,IAAwBS,EAC1Ba,EAAmBD,OAEnBC,EAAmBF,OAGjB,CAAC3B,EAAgBC,GAAoByB,SAASV,GAChDc,EAAmBH,OAEnBG,EAAmBF,OAGjB,CACF7B,EACAC,EACAI,EACAC,EACAE,GACAmB,SAASV,GAETe,EAAqBJ,OAErBI,EAAqBH,OAGnB,CACF7B,EACAC,EACAE,EACAC,EACAC,EACAC,EACAE,EACAD,GACAoB,SAASV,GAETgB,EAAmBL,OAEnBK,EAAmBJ,OAGrBK,EAAuBC,KAAKf,+CAQVgB,GAAQ,IAAAC,EAAA1B,KACpB2B,EAAmBxC,EAAE,wBAE3BA,EAAEyC,KAAK,CACLC,IAAKF,EAAiBG,KAAK,OAC3BA,KAAM,CACJL,OAAQA,GAEVM,SAAU,SACTC,KAAK,SAAAC,GACNP,EAAKQ,uBAAuBP,GAE5B,IAAK,IAAIxE,EAAI,EAAGA,EAAI8E,EAASE,OAAQhF,IACnCuE,EAAKU,sBACHT,EACAM,EAAS9E,GAAGkF,OAASJ,EAAS9E,GAAGmF,SAAW,IAAM,IAClDL,EAAS9E,GAAGoF,aAIhBZ,EAAiBtB,KAAK,2BAA2BmC,2DAU9BC,GACrBA,EAAWpC,KAAK,2BAA2BmC,QAAQ,QACnDC,EAAWC,+CAUEC,EAAQC,GACrB,IAAIC,EAAW1D,EAAE,wCAAwC2D,QAEzDD,EAASE,KAAK,eAAgBH,GAC9BC,EAASG,YAAY,8CACrBL,EAAOM,OAAOJ,iDAWMK,EAAWC,EAAWP,GAC1C,IAAID,EAASxD,EAAE,gCAAgC2D,QAE/CH,EAAOjC,KAAKyC,GAERP,GAEF5C,KAAKoD,eAAeT,EAAQC,GAG9BD,EAAOK,YAAY,sCACnBL,EAAOU,SAASH;;;;;;;;;;;;;;;;;;;;;;;;;AC7KpB,IAAM/D,EAAIC,OAAOD,EAEImE,aACnB,SAAAA,IAAc,IAAAvD,EAAAC,kGAAAuD,CAAAvD,KAAAsD,GACZ,IAAIxD,EAEJX,EAAE,8BAA8Be,GAAG,QAAS,kBAAMH,EAAKyD,4BACvDrE,EAAE,qCAAqCe,GAAG,QAAS,kBAAMH,EAAK0D,6BAC9DtE,EAAE,qBAAqBe,GAAG,QAAS,mBAAoB,SAACwD,GAAD,OAAW3D,EAAK4D,wBAAwBD,KAC/FvE,EAAE,8BAA8Be,GAAG,QAAS,kBAAMH,EAAK6D,4BACvDzE,EAAE,mBAAmBe,GAAG,SAAU,kBAAMH,EAAK8D,eAE7C7D,KAAK8D,qBACL9D,KAAK+D,6EAQL5E,EAAE,mBAAmBe,GAAG,SAAU,WAChC,IAAM8D,EAAQ7E,EAAEa,MAChB,GAA2D,MAAvDgE,EAAM3D,KAAK,kCAAkCG,MAC/C,OAAOyD,QAAO,GAAAC,OAAIF,EAAMlC,KAAK,0BAAf,KAAAoC,OAA4C/E,EAAEgF,KAAKhF,EAAE,6BAA6BuB,OAAOC,eAAzF,qDASlB,IAAIyD,EAAiBjF,EAAE,QAAQqB,MACH,EAAxB4D,EAAejC,SACjBnC,KAAKqE,oBAAoBD,GACzBpE,KAAKsE,yEAKPtE,KAAKuE,sBACLvE,KAAKwE,wEAOLxE,KAAKyE,mBACLzE,KAAKsE,yEAOLtE,KAAK0E,oBACL1E,KAAKwE,iEAOLrF,EAAE,2BAA2B6D,YAAY,sDAOzC7D,EAAE,2BAA2BwF,SAAS,0DAMhBjB,GACtB,IAAIkB,EAAWzF,EAAEuE,EAAMmB,QAAQC,QAAQ,cAAchD,KAAK,QAE1D3C,EAAE,yBAAyBqB,IAAIoE,GAE/B5E,KAAKqE,oBAAoBO,GACzB5E,KAAK0E,gEAMaE,GAClBzF,EAAE,yBAAyB6D,YAAY,UACvC7D,EAAE,mBAAmBuB,KAAKkE,iDAO1BzF,EAAE,yBAAyBwF,SAAS,wDAOpCxF,EAAE,8BAA8BwF,SAAS,wDAOzCxF,EAAE,8BAA8B6D,YAAY,0DAO5C7D,EAAE,8BAA8B4F,WAAW,wDAUzBC,EAAUC,EAAUC,GACtC,IAAMnE,EAAS5B,EAAE,yBAEXgG,EAAWH,EAAW,KAAOhF,KAAKoF,aAAaH,GAAY,IAEjElE,EAAOV,KAAK,iBAAiBmB,KAAK2D,GAClCpE,EAAOV,KAAK,qBAAqBmB,KAAK0D,GACtCnE,EAAOiC,YAAY,wDAOJ7D,EAAE,yBACVwF,SAAS,+CAULU,GACX,MAAqB,iBAAVA,EACF,GAGI,KAATA,GACMA,EAAQ,KAAYC,QAAQ,GAAK,MAG9B,KAATD,GACMA,EAAQ,KAASC,QAAQ,GAAK,OAGhCD,EAAQ,KAAMC,QAAQ,GAAK,2CAMxB,IAAA5D,EAAA1B,KACXA,KAAKuF,sBAEL,IAAMC,EAASrG,EAAE,SACXsG,EAAeD,EAAOE,KAAK,SAAS,GAG1C,GADsBF,EAAO1D,KAAK,wBACd2D,EAAaE,KAC/B3F,KAAK4F,oBAAoBH,EAAa/H,KAAM+H,EAAaE,KAAM,yBADjE,CAKA,IAAM7D,EAAO,IAAI+D,SACjB/D,EAAKmB,OAAO,OAAQwC,GAEpBtG,EAAEyC,KAAK,CACLkE,KAAM,OACNjE,IAAK1C,EAAE,mBAAmB2C,KAAK,mBAC/BA,KAAMA,EACNiE,OAAO,EACPC,aAAa,EACbC,aAAa,IACZjE,KAAK,SAAAC,GACN,GAAIA,EAASiE,MACXxE,EAAKkE,oBAAoBH,EAAa/H,KAAM+H,EAAaE,KAAM1D,EAASiE,WAD1E,CAKA,IAAItB,EAAW3C,EAASkE,KAAKzI,KAE7ByB,EAAE,yBAAyBqB,IAAIoE,GAE/BlD,EAAK2C,oBAAoBO,GACzBlD,EAAK4C,sBACL5C,EAAK0E,sBAAsBxB,GAC3BlD,EAAK2E,0EASazB,GACpB,IAAM0B,EAASnH,EAAE,qBAGboH,EADgBD,EAAOxE,KAAK,mBACA,aAAe0E,mBAAmB5B,GAG9D6B,EADkBH,EAAOxE,KAAK,qBACE,aAAe0E,mBAAmB5B,GAElE8B,EAAYJ,EAAOjG,KAAK,YAAYyC,QAExC4D,EAAU1D,YAAY,UACtB0D,EAAUrG,KAAK,YAAYK,KAAKkE,GAChC8B,EAAUrG,KAAK,cAAc0C,KAAK,YAAa6B,GAC/C8B,EAAUrG,KAAK,uBAAuB0C,KAAK,OAAQwD,GACnDG,EAAUrG,KAAK,yBAAyB0C,KAAK,OAAQ0D,GAErDH,EAAOjG,KAAK,SAAS4C,OAAOyD,GAE5B,IAAIC,EAAcL,EAAOjG,KAAK,MAAM8B,OAAS,EAC7ChD,EAAE,4BAA4BuB,KAAKiG,yCC5OvCxH,EAFUC,OAAOD,GAEf,WACA,IAAImE","file":"imports.bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 256);\n","/**\n * 2007-2018 PrestaShop\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * https://opensource.org/licenses/OSL-3.0\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@prestashop.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade PrestaShop to newer\n * versions in the future. If you wish to customize PrestaShop for your\n * needs please refer to http://www.prestashop.com for more information.\n *\n * @author    PrestaShop SA <contact@prestashop.com>\n * @copyright 2007-2018 PrestaShop SA\n * @license   https://opensource.org/licenses/OSL-3.0 Open Software License (OSL 3.0)\n * International Registered Trademark & Property of PrestaShop SA\n */\n\nconst $ = window.$;\n\nconst entityCategories = 0;\nconst entityProducts = 1;\nconst entityCombinations = 2;\nconst entityCustomers = 3;\nconst entityAddresses = 4;\nconst entityBrands = 5;\nconst entitySuppliers = 6;\nconst entityAlias = 7;\nconst entityStoreContacts = 8;\n\nexport default class FormFieldToggle {\n  constructor() {\n    $('.js-entity-select').on('change', () => this.toggleForm());\n\n    this.toggleForm();\n  }\n\n  toggleForm() {\n    let selectedOption = $('#entity').find('option:selected');\n    let selectedEntity = parseInt(selectedOption.val());\n    let entityName = selectedOption.text().toLowerCase();\n\n    this.toggleEntityAlert(selectedEntity);\n    this.toggleFields(selectedEntity, entityName);\n    this.loadAvailableFields(selectedEntity);\n  }\n\n  /**\n   * Toggle alert warning for selected import entity\n   *\n   * @param {int} selectedEntity\n   */\n  toggleEntityAlert(selectedEntity) {\n    let $alert = $('.js-entity-alert');\n\n    if ([entityCategories, entityProducts].includes(selectedEntity)) {\n      $alert.show();\n    } else {\n      $alert.hide();\n    }\n  }\n\n  /**\n   * Toggle available options for selected entity\n   *\n   * @param {int} selectedEntity\n   * @param {string} entityName\n   */\n  toggleFields(selectedEntity, entityName) {\n    const $truncateFormGroup = $('.js-truncate-form-group');\n    const $matchRefFormGroup = $('.js-match-ref-form-group');\n    const $regenerateFormGroup = $('.js-regenerate-form-group');\n    const $forceIdsFormGroup = $('.js-force-ids-form-group');\n    const $entityNamePlaceholder = $('.js-entity-name');\n\n    if (entityStoreContacts === selectedEntity) {\n      $truncateFormGroup.hide();\n    } else {\n      $truncateFormGroup.show();\n    }\n\n    if ([entityProducts, entityCombinations].includes(selectedEntity)) {\n      $matchRefFormGroup.show();\n    } else {\n      $matchRefFormGroup.hide();\n    }\n\n    if ([\n      entityCategories,\n      entityProducts,\n      entityBrands,\n      entitySuppliers,\n      entityStoreContacts\n    ].includes(selectedEntity)\n    ) {\n      $regenerateFormGroup.show();\n    } else {\n      $regenerateFormGroup.hide();\n    }\n\n    if ([\n      entityCategories,\n      entityProducts,\n      entityCustomers,\n      entityAddresses,\n      entityBrands,\n      entitySuppliers,\n      entityStoreContacts,\n      entityAlias\n    ].includes(selectedEntity)\n    ) {\n      $forceIdsFormGroup.show();\n    } else {\n      $forceIdsFormGroup.hide();\n    }\n\n    $entityNamePlaceholder.html(entityName);\n  }\n\n  /**\n   * Load available fields for given entity\n   *\n   * @param {int} entity\n   */\n  loadAvailableFields(entity) {\n    const $availableFields = $('.js-available-fields');\n\n    $.ajax({\n      url: $availableFields.data('url'),\n      data: {\n        entity: entity\n      },\n      dataType: 'json',\n    }).then(response => {\n      this._removeAvailableFields($availableFields);\n\n      for (let i = 0; i < response.length; i++) {\n        this._appendAvailableField(\n          $availableFields,\n          response[i].label + (response[i].required ? '*' : ''),\n          response[i].description\n        );\n      }\n\n      $availableFields.find('[data-toggle=\"popover\"]').popover();\n    });\n  }\n\n  /**\n   * Remove available fields content from given container.\n   *\n   * @param {jQuery} $container\n   * @private\n   */\n  _removeAvailableFields($container) {\n    $container.find('[data-toggle=\"popover\"]').popover('hide');\n    $container.empty();\n  }\n\n  /**\n   * Append a help box to given field.\n   *\n   * @param {jQuery} $field\n   * @param {String} helpBoxContent\n   * @private\n   */\n  _appendHelpBox($field, helpBoxContent) {\n    let $helpBox = $('.js-available-field-popover-template').clone();\n\n    $helpBox.attr('data-content', helpBoxContent);\n    $helpBox.removeClass('js-available-field-popover-template d-none');\n    $field.append($helpBox);\n  }\n\n  /**\n   * Append available field to given container.\n   *\n   * @param {jQuery} $appendTo field will be appended to this container.\n   * @param {String} fieldText\n   * @param {String} helpBoxContent\n   * @private\n   */\n  _appendAvailableField($appendTo, fieldText, helpBoxContent) {\n    let $field = $('.js-available-field-template').clone();\n\n    $field.text(fieldText);\n\n    if (helpBoxContent) {\n      // Append help box next to the field\n      this._appendHelpBox($field, helpBoxContent);\n    }\n\n    $field.removeClass('js-available-field-template d-none');\n    $field.appendTo($appendTo);\n  }\n}\n","/**\n * 2007-2018 PrestaShop\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * https://opensource.org/licenses/OSL-3.0\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@prestashop.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade PrestaShop to newer\n * versions in the future. If you wish to customize PrestaShop for your\n * needs please refer to http://www.prestashop.com for more information.\n *\n * @author    PrestaShop SA <contact@prestashop.com>\n * @copyright 2007-2018 PrestaShop SA\n * @license   https://opensource.org/licenses/OSL-3.0 Open Software License (OSL 3.0)\n * International Registered Trademark & Property of PrestaShop SA\n */\n\nimport FormFieldToggle from \"./FormFieldToggle\";\n\nconst $ = window.$;\n\nexport default class ImportPage {\n  constructor() {\n    new FormFieldToggle();\n\n    $('.js-from-files-history-btn').on('click', () => this.showFilesHistoryHandler());\n    $('.js-close-files-history-block-btn').on('click', () => this.closeFilesHistoryHandler());\n    $('#fileHistoryTable').on('click', '.js-use-file-btn', (event) => this.useFileFromFilesHistory(event));\n    $('.js-change-import-file-btn').on('click', () => this.changeImportFileHandler());\n    $('.js-import-file').on('change', () => this.uploadFile());\n\n    this.toggleSelectedFile();\n    this.handleSubmit();\n  }\n\n  /**\n   * Handle submit and add confirm box in case the toggle button about\n   * deleting all entities before import is checked\n   */\n  handleSubmit() {\n    $('.js-import-form').on('submit', function() {\n      const $this = $(this);\n      if ($this.find('input[name=\"truncate\"]:checked').val() === '1') {\n        return confirm(`${$this.data('delete-confirm-message')} ${$.trim($('#entity > option:selected').text().toLowerCase())}?`);\n      }\n    });\n  }\n\n  /**\n   * Check if selected file names exists and if so, then display it\n   */\n  toggleSelectedFile() {\n    let selectFilename = $('#csv').val();\n    if (selectFilename.length > 0) {\n      this.showImportFileAlert(selectFilename);\n      this.hideFileUploadBlock();\n    }\n  }\n\n  changeImportFileHandler() {\n    this.hideImportFileAlert();\n    this.showFileUploadBlock();\n  }\n\n  /**\n   * Show files history event handler\n   */\n  showFilesHistoryHandler() {\n    this.showFilesHistory();\n    this.hideFileUploadBlock();\n  }\n\n  /**\n   * Close files history event handler\n   */\n  closeFilesHistoryHandler() {\n    this.closeFilesHistory();\n    this.showFileUploadBlock();\n  }\n\n  /**\n   * Show files history block\n   */\n  showFilesHistory() {\n    $('.js-files-history-block').removeClass('d-none');\n  }\n\n  /**\n   * Hide files history block\n   */\n  closeFilesHistory() {\n    $('.js-files-history-block').addClass('d-none');\n  }\n\n  /**\n   *  Prefill hidden file input with selected file name from history\n   */\n  useFileFromFilesHistory(event) {\n    let filename = $(event.target).closest('.btn-group').data('file');\n\n    $('.js-import-file-input').val(filename);\n\n    this.showImportFileAlert(filename);\n    this.closeFilesHistory();\n  }\n\n  /**\n   * Show alert with imported file name\n   */\n  showImportFileAlert(filename) {\n    $('.js-import-file-alert').removeClass('d-none');\n    $('.js-import-file').text(filename);\n  }\n\n  /**\n   * Hides selected import file alert\n   */\n  hideImportFileAlert() {\n    $('.js-import-file-alert').addClass('d-none');\n  }\n\n  /**\n   * Hides import file upload block\n   */\n  hideFileUploadBlock() {\n    $('.js-file-upload-form-group').addClass('d-none');\n  }\n\n  /**\n   * Hides import file upload block\n   */\n  showFileUploadBlock() {\n    $('.js-file-upload-form-group').removeClass('d-none');\n  }\n\n  /**\n   * Make file history button clickable\n   */\n  enableFilesHistoryBtn() {\n    $('.js-from-files-history-btn').removeAttr('disabled');\n  }\n\n  /**\n   * Show error message if file uploading failed\n   *\n   * @param {string} fileName\n   * @param {integer} fileSize\n   * @param {string} message\n   */\n  showImportFileError(fileName, fileSize, message) {\n    const $alert = $('.js-import-file-error');\n\n    const fileData = fileName + ' (' + this.humanizeSize(fileSize) + ')';\n\n    $alert.find('.js-file-data').html(fileData);\n    $alert.find('.js-error-message').html(message);\n    $alert.removeClass('d-none');\n  }\n\n  /**\n   * Hide file uploading error\n   */\n  hideImportFileError() {\n    const $alert = $('.js-import-file-error');\n    $alert.addClass('d-none');\n  }\n\n  /**\n   * Show file size in human readable format\n   *\n   * @param {int} bytes\n   *\n   * @returns {string}\n   */\n  humanizeSize(bytes) {\n    if (typeof bytes !== 'number') {\n      return '';\n    }\n\n    if (bytes >= 1000000000) {\n      return (bytes / 1000000000).toFixed(2) + ' GB';\n    }\n\n    if (bytes >= 1000000) {\n      return (bytes / 1000000).toFixed(2) + ' MB';\n    }\n\n    return (bytes / 1000).toFixed(2) + ' KB';\n  }\n\n  /**\n   * Upload selected import file\n   */\n  uploadFile() {\n    this.hideImportFileError();\n\n    const $input = $('#file');\n    const uploadedFile = $input.prop('files')[0];\n\n    const maxUploadSize = $input.data('max-file-upload-size');\n    if (maxUploadSize < uploadedFile.size) {\n      this.showImportFileError(uploadedFile.name, uploadedFile.size, 'File is too large');\n      return;\n    }\n\n    const data = new FormData();\n    data.append('file', uploadedFile);\n\n    $.ajax({\n      type: 'POST',\n      url: $('.js-import-form').data('file-upload-url'),\n      data: data,\n      cache: false,\n      contentType: false,\n      processData: false,\n    }).then(response => {\n      if (response.error) {\n        this.showImportFileError(uploadedFile.name, uploadedFile.size, response.error);\n        return;\n      }\n\n      let filename = response.file.name;\n\n      $('.js-import-file-input').val(filename);\n\n      this.showImportFileAlert(filename);\n      this.hideFileUploadBlock();\n      this.addFileToHistoryTable(filename);\n      this.enableFilesHistoryBtn();\n    });\n  }\n\n  /**\n   * Renders new row in files history table\n   *\n   * @param {string} filename\n   */\n  addFileToHistoryTable(filename) {\n    const $table = $('#fileHistoryTable');\n\n    let baseDeleteUrl = $table.data('delete-file-url');\n    let deleteUrl = baseDeleteUrl + '&filename=' + encodeURIComponent(filename);\n\n    let baseDownloadUrl = $table.data('download-file-url');\n    let downloadUrl = baseDownloadUrl + '&filename=' + encodeURIComponent(filename);\n\n    let $template = $table.find('tr:first').clone();\n\n    $template.removeClass('d-none');\n    $template.find('td:first').text(filename);\n    $template.find('.btn-group').attr('data-file', filename);\n    $template.find('.js-delete-file-btn').attr('href', deleteUrl);\n    $template.find('.js-download-file-btn').attr('href', downloadUrl);\n\n    $table.find('tbody').append($template);\n\n    let filesNumber = $table.find('tr').length - 1;\n    $('.js-files-history-number').text(filesNumber);\n  }\n}\n","/**\n * 2007-2018 PrestaShop\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * https://opensource.org/licenses/OSL-3.0\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@prestashop.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade PrestaShop to newer\n * versions in the future. If you wish to customize PrestaShop for your\n * needs please refer to http://www.prestashop.com for more information.\n *\n * @author    PrestaShop SA <contact@prestashop.com>\n * @copyright 2007-2018 PrestaShop SA\n * @license   https://opensource.org/licenses/OSL-3.0 Open Software License (OSL 3.0)\n * International Registered Trademark & Property of PrestaShop SA\n */\n\nimport ImportPage from './ImportPage';\n\nconst $ = window.$;\n\n$(() => {\n  new ImportPage();\n});\n"],"sourceRoot":""}