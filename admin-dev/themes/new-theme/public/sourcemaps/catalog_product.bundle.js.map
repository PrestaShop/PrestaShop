{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./js/pages/catalog/product/specific-price-form-handler.js","webpack:///./js/pages/catalog/product/index.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","$","window","SpecificPriceFormHandler","_classCallCheck","this","prefixCreateForm","prefixEditForm","editModalIsOpen","$createPriceFormDefaultValues","storePriceFormDefaultValues","loadAndDisplayExistingSpecificPricesList","configureAddPriceFormBehavior","configureEditPriceModalBehavior","configureDeletePriceButtonsBehavior","configureMultipleModalsBehavior","_this","listContainer","url","data","replace","getProductId","ajax","type","done","specificPrices","tbody","find","remove","length","removeClass","addClass","specificPricesList","renderSpecificPricesListingAsHtml","append","self","each","index","specificPrice","deleteUrl","attr","id_specific_price","row","renderSpecificPriceRow","specificPriceId","rule_name","attributes_name","currency","country","group","customer","fixed_price","impact","period","from_quantity","can_delete","can_edit","_this2","selectorPrefix","getPrefixSelector","click","resetCreatePriceFormDefaultValues","collapse","on","submitCreatePriceForm","loadAndFillOptionsForSelectCombinationInput","enableSpecificPriceFieldIfEligible","enableSpecificPriceTaxFieldIfEligible","_this3","closeEditPriceModalAndRemoveForm","submitEditPriceForm","reinitializeDatePickers","initializeLeaveBPriceField","datetimepicker","format","usePrefixForCreate","val","prop","_this4","document","event","preventDefault","currentTarget","openEditPriceModalAndLoadForm","_this5","deleteSpecificPrice","_this6","_this7","serialize","response","showSuccessMessage","translate_javascripts","removeAttr","fail","errors","showErrorMessage","responseJSON","_this8","baseUrl","clickedLink","_this9","modalConfirmation","onContinue","show","storage","inputField","combinations","combination","id","trigger","hide","previouslyStoredValues","change","is","_this10","modal","insertEditSpecificPriceFormIntoModal","configureEditPriceFormInsideModalBehavior","empty","form","formLocationHolder"],"mappings":"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","file":"catalog_product.bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 262);\n","/**\n * 2007-2018 PrestaShop\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * https://opensource.org/licenses/OSL-3.0\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@prestashop.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade PrestaShop to newer\n * versions in the future. If you wish to customize PrestaShop for your\n * needs please refer to http://www.prestashop.com for more information.\n *\n * @author    PrestaShop SA <contact@prestashop.com>\n * @copyright 2007-2018 PrestaShop SA\n * @license   https://opensource.org/licenses/OSL-3.0 Open Software License (OSL 3.0)\n * International Registered Trademark & Property of PrestaShop SA\n */\n\nconst $ = window.$;\n\nclass SpecificPriceFormHandler {\n\n  constructor() {\n    this.prefixCreateForm = 'form_step2_specific_price_';\n    this.prefixEditForm = 'form_modal_';\n    this.editModalIsOpen = false;\n\n    this.$createPriceFormDefaultValues = new Object();\n    this.storePriceFormDefaultValues();\n\n    this.loadAndDisplayExistingSpecificPricesList();\n\n    this.configureAddPriceFormBehavior();\n\n    this.configureEditPriceModalBehavior();\n\n    this.configureDeletePriceButtonsBehavior();\n\n    this.configureMultipleModalsBehavior();\n  }\n\n  /**\n   * @private\n   */\n  loadAndDisplayExistingSpecificPricesList() {\n    var listContainer = $('#js-specific-price-list');\n    var url = listContainer.data('listingUrl').replace(/list\\/\\d+/, 'list/' + this.getProductId());\n\n    $.ajax({\n      type: 'GET',\n      url: url,\n    })\n        .done(specificPrices => {\n          var tbody = listContainer.find('tbody');\n          tbody.find('tr').remove();\n\n          if (specificPrices.length > 0) {\n            listContainer.removeClass('hide');\n          } else {\n            listContainer.addClass('hide');\n          }\n\n          var specificPricesList = this.renderSpecificPricesListingAsHtml(specificPrices);\n\n          tbody.append(specificPricesList);\n        });\n  }\n\n  /**\n   * @param array specificPrices\n   *\n   * @returns string\n   *\n   * @private\n   */\n  renderSpecificPricesListingAsHtml(specificPrices) {\n    var specificPricesList = '';\n\n    var self = this;\n\n    $.each(specificPrices, (index, specificPrice) => {\n      var deleteUrl = $('#js-specific-price-list').attr('data-action-delete').replace(/delete\\/\\d+/, 'delete/' + specificPrice.id_specific_price);\n      var row = self.renderSpecificPriceRow(specificPrice, deleteUrl);\n\n      specificPricesList = specificPricesList + row;\n    });\n\n    return specificPricesList;\n  }\n\n  /**\n   * @param Object specificPrice\n   * @param string deleteUrl\n   *\n   * @returns string\n   *\n   * @private\n   */\n  renderSpecificPriceRow(specificPrice, deleteUrl) {\n\n    var specificPriceId = specificPrice.id_specific_price;\n\n    var row = '<tr>' +\n        '<td>' + specificPrice.rule_name + '</td>' +\n        '<td>' + specificPrice.attributes_name + '</td>' +\n        '<td>' + specificPrice.currency + '</td>' +\n        '<td>' + specificPrice.country + '</td>' +\n        '<td>' + specificPrice.group + '</td>' +\n        '<td>' + specificPrice.customer + '</td>' +\n        '<td>' + specificPrice.fixed_price + '</td>' +\n        '<td>' + specificPrice.impact + '</td>' +\n        '<td>' + specificPrice.period + '</td>' +\n        '<td>' + specificPrice.from_quantity + '</td>' +\n        '<td>' + (specificPrice.can_delete ? '<a href=\"' + deleteUrl + '\" class=\"js-delete delete btn tooltip-link delete pl-0 pr-0\"><i class=\"material-icons\">delete</i></a>' : '') + '</td>' +\n        '<td>' + (specificPrice.can_edit ? '<a href=\"#\" data-specific-price-id=\"' + specificPriceId + '\" class=\"js-edit edit btn tooltip-link delete pl-0 pr-0\"><i class=\"material-icons\">edit</i></a>' : '') + '</td>' +\n        '</tr>';\n\n    return row;\n  }\n\n  /**\n   * @private\n   */\n  configureAddPriceFormBehavior() {\n    const usePrefixForCreate = true;\n    var selectorPrefix = this.getPrefixSelector(usePrefixForCreate);\n\n    $('#specific_price_form .js-cancel').click(() => {\n      this.resetCreatePriceFormDefaultValues();\n      $('#specific_price_form').collapse('hide');\n    });\n\n    $('#specific_price_form .js-save').on('click', () => this.submitCreatePriceForm());\n\n    $('#js-open-create-specific-price-form').on('click', () => this.loadAndFillOptionsForSelectCombinationInput(usePrefixForCreate));\n\n    $(selectorPrefix + 'leave_bprice').on('click', () => this.enableSpecificPriceFieldIfEligible(usePrefixForCreate));\n\n    $(selectorPrefix + 'sp_reduction_type').on('change', () => this.enableSpecificPriceTaxFieldIfEligible(usePrefixForCreate));\n  }\n\n  /**\n   * @private\n   */\n  configureEditPriceFormInsideModalBehavior() {\n    const usePrefixForCreate = false;\n    var selectorPrefix = this.getPrefixSelector(usePrefixForCreate);\n\n    $('#form_modal_cancel').click(() => this.closeEditPriceModalAndRemoveForm());\n    $('#form_modal_close').click(() => this.closeEditPriceModalAndRemoveForm());\n\n    $('#form_modal_save').click(() => this.submitEditPriceForm());\n\n    this.loadAndFillOptionsForSelectCombinationInput(usePrefixForCreate);\n\n    $(selectorPrefix + 'leave_bprice').on('click', () => this.enableSpecificPriceFieldIfEligible(usePrefixForCreate));\n\n    $(selectorPrefix + 'sp_reduction_type').on('change', () => this.enableSpecificPriceTaxFieldIfEligible(usePrefixForCreate));\n\n    this.reinitializeDatePickers();\n\n    this.initializeLeaveBPriceField(usePrefixForCreate);\n    this.enableSpecificPriceTaxFieldIfEligible(usePrefixForCreate);\n  }\n\n  /**\n   * @private\n   */\n  reinitializeDatePickers() {\n    $('.datepicker input').datetimepicker({format: 'YYYY-MM-DD'});\n  }\n\n  /**\n   * @param boolean usePrefixForCreate\n   *\n   * @private\n   */\n  initializeLeaveBPriceField(usePrefixForCreate) {\n    var selectorPrefix = this.getPrefixSelector(usePrefixForCreate);\n\n    if ($(selectorPrefix + 'sp_price').val() != '') {\n      $(selectorPrefix + 'sp_price').prop('disabled', false);\n      $(selectorPrefix + 'leave_bprice').prop('checked', false);\n    }\n  }\n\n  /**\n   * @private\n   */\n  configureEditPriceModalBehavior() {\n    $(document).on('click', '#js-specific-price-list .js-edit', (event) => {\n      event.preventDefault();\n\n      var specificPriceId = $(event.currentTarget).data('specificPriceId');\n\n      this.openEditPriceModalAndLoadForm(specificPriceId);\n    });\n\n  }\n\n  /**\n   * @private\n   */\n  configureDeletePriceButtonsBehavior() {\n    $(document).on('click', '#js-specific-price-list .js-delete', (event) => {\n      event.preventDefault();\n      this.deleteSpecificPrice(event.currentTarget);\n    });\n  }\n\n  /**\n   * @see https://vijayasankarn.wordpress.com/2017/02/24/quick-fix-scrolling-and-focus-when-multiple-bootstrap-modals-are-open/\n   */\n  configureMultipleModalsBehavior() {\n    $('.modal').on('hidden.bs.modal', () => {\n      if (this.editModalIsOpen) {\n        $('body').addClass('modal-open');\n      }\n    });\n  }\n\n  /**\n   * @private\n   */\n  submitCreatePriceForm() {\n\n    const url = $('#specific_price_form').attr('data-action');\n    const data = $('#specific_price_form input, #specific_price_form select, #form_id_product').serialize();\n\n    $('#specific_price_form .js-save').attr('disabled', 'disabled');\n\n    $.ajax({\n      type: 'POST',\n      url: url,\n      data: data,\n    })\n        .done(response => {\n          showSuccessMessage(translate_javascripts['Form update success']);\n          this.resetCreatePriceFormDefaultValues();\n          $('#specific_price_form').collapse('hide');\n          this.loadAndDisplayExistingSpecificPricesList();\n\n          $('#specific_price_form .js-save').removeAttr('disabled');\n\n        })\n        .fail(errors => {\n          showErrorMessage(errors.responseJSON);\n\n          $('#specific_price_form .js-save').removeAttr('disabled');\n        });\n  }\n\n  /**\n   * @private\n   */\n  submitEditPriceForm() {\n    const baseUrl = $('#edit-specific-price-modal-form').attr('data-action');\n    const specificPriceId = $('#edit-specific-price-modal-form').data('specificPriceId');\n    const url = baseUrl.replace(/update\\/\\d+/, 'update/' + specificPriceId);\n\n    const data = $('#edit-specific-price-modal-form input, #edit-specific-price-modal-form select, #form_id_product').serialize();\n\n    $('#edit-specific-price-modal-form .js-save').attr('disabled', 'disabled');\n\n    $.ajax({\n      type: 'POST',\n      url: url,\n      data: data,\n    })\n        .done(response => {\n          showSuccessMessage(translate_javascripts['Form update success']);\n          this.closeEditPriceModalAndRemoveForm();\n          this.loadAndDisplayExistingSpecificPricesList();\n          $('#edit-specific-price-modal-form .js-save').removeAttr('disabled');\n        })\n        .fail(errors => {\n          showErrorMessage(errors.responseJSON);\n\n          $('#edit-specific-price-modal-form .js-save').removeAttr('disabled');\n        });\n  }\n\n  /**\n   * @param string clickedLink selector\n   *\n   * @private\n   */\n  deleteSpecificPrice(clickedLink) {\n    modalConfirmation.create(translate_javascripts['This will delete the specific price. Do you wish to proceed?'], null, {\n      onContinue: () => {\n\n        var url = $(clickedLink).attr('href');\n        $(clickedLink).attr('disabled', 'disabled');\n\n        $.ajax({\n          type: 'GET',\n          url: url,\n        })\n            .done(response => {\n              this.loadAndDisplayExistingSpecificPricesList();\n              showSuccessMessage(response);\n              $(clickedLink).removeAttr('disabled');\n            })\n            .fail(errors => {\n              showErrorMessage(errors.responseJSON);\n              $(clickedLink).removeAttr('disabled');\n\n            });\n      }\n    }).show();\n  }\n\n  /**\n   * Store 'add specific price' form values\n   * for future usage\n   *\n   * @private\n   */\n  storePriceFormDefaultValues() {\n    var storage = this.$createPriceFormDefaultValues;\n\n    $('#specific_price_form').find('select,input').each((index, value) => {\n      storage[$(value).attr('id')] = $(value).val();\n    });\n\n    $('#specific_price_form').find('input:checkbox').each((index, value) => {\n      storage[$(value).attr('id')] = $(value).prop('checked');\n    });\n\n    this.$createPriceFormDefaultValues = storage;\n  }\n\n  /**\n   * @param boolean usePrefixForCreate\n   *\n   * @private\n   */\n  loadAndFillOptionsForSelectCombinationInput(usePrefixForCreate) {\n\n    var selectorPrefix = this.getPrefixSelector(usePrefixForCreate);\n\n    var inputField = $(selectorPrefix + 'sp_id_product_attribute');\n    var url = inputField.attr('data-action').replace(/product-combinations\\/\\d+/, 'product-combinations/' + this.getProductId());\n\n    $.ajax({\n      type: 'GET',\n      url: url,\n    })\n        .done(combinations => {\n          /** remove all options except first one */\n          inputField.find('option:gt(0)').remove();\n\n          $.each(combinations, (index, combination) => {\n            inputField.append('<option value=\"' + combination.id + '\">' + combination.name + '</option>');\n          });\n\n          if (inputField.data('selectedAttribute') != '0') {\n            inputField.val(inputField.data('selectedAttribute')).trigger('change');\n          }\n        });\n  }\n\n  /**\n   * @param boolean usePrefixForCreate\n   *\n   * @private\n   */\n  enableSpecificPriceTaxFieldIfEligible(usePrefixForCreate) {\n\n    var selectorPrefix = this.getPrefixSelector(usePrefixForCreate);\n\n    if ($(selectorPrefix + 'sp_reduction_type').val() === 'percentage') {\n      $(selectorPrefix + 'sp_reduction_tax').hide();\n    } else {\n      $(selectorPrefix + 'sp_reduction_tax').show();\n    }\n  }\n\n  /**\n   * Reset 'add specific price' form values\n   * using previously stored default values\n   *\n   * @private\n   */\n  resetCreatePriceFormDefaultValues() {\n    var previouslyStoredValues = this.$createPriceFormDefaultValues;\n\n    $('#specific_price_form').find('input').each((index, value) => {\n      $(value).val(previouslyStoredValues[$(value).attr('id')]);\n    });\n\n    $('#specific_price_form').find('select').each((index, value) => {\n      $(value).val(previouslyStoredValues[$(value).attr('id')]).change();\n    });\n\n    $('#specific_price_form').find('input:checkbox').each((index, value) => {\n      $(value).prop(\"checked\", true);\n    });\n  }\n\n  /**\n   * @param boolean usePrefixForCreate\n   *\n   * @private\n   */\n  enableSpecificPriceFieldIfEligible(usePrefixForCreate) {\n    var selectorPrefix = this.getPrefixSelector(usePrefixForCreate);\n\n    $(selectorPrefix + 'sp_price').prop('disabled', $(selectorPrefix + 'leave_bprice').is(':checked')).val('');\n  }\n\n  /**\n   * Open 'edit specific price' form into a modal\n   *\n   * @param integer specificPriceId\n   *\n   * @private\n   */\n  openEditPriceModalAndLoadForm(specificPriceId) {\n    const url = $('#js-specific-price-list').data('actionEdit').replace(/form\\/\\d+/, 'form/' + specificPriceId);\n\n    $('#edit-specific-price-modal').modal(\"show\");\n    this.editModalIsOpen = true;\n\n    $.ajax({\n      type: 'GET',\n      url: url,\n    })\n        .done(response => {\n          this.insertEditSpecificPriceFormIntoModal(response);\n          $('#edit-specific-price-modal-form').data('specificPriceId', specificPriceId);\n          this.configureEditPriceFormInsideModalBehavior();\n        })\n        .fail(errors => {\n          showErrorMessage(errors.responseJSON);\n        });\n  }\n\n  /**\n   * @private\n   */\n  closeEditPriceModalAndRemoveForm() {\n    $('#edit-specific-price-modal').modal(\"hide\");\n    this.editModalIsOpen = false;\n\n    var formLocationHolder = $('#edit-specific-price-modal-form');\n\n    formLocationHolder.empty();\n  }\n\n  /**\n   * @param string form: HTML 'edit specific price' form\n   *\n   * @private\n   */\n  insertEditSpecificPriceFormIntoModal(form) {\n    var formLocationHolder = $('#edit-specific-price-modal-form');\n\n    formLocationHolder.empty();\n    formLocationHolder.append(form);\n  }\n\n  /**\n   * Get product ID for current Catalog Product page\n   *\n   * @returns integer\n   *\n   * @private\n   */\n  getProductId() {\n    return $('#form_id_product').val();\n  }\n\n  /**\n   * @param boolean usePrefixForCreate\n   *\n   * @returns string\n   *\n   * @private\n   */\n  getPrefixSelector(usePrefixForCreate) {\n    if (usePrefixForCreate == true) {\n      return '#' + this.prefixCreateForm;\n    } else {\n      return '#' + this.prefixEditForm;\n    }\n  }\n}\n\nexport default SpecificPriceFormHandler;\n","/**\n * 2007-2018 PrestaShop\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Open Software License (OSL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * https://opensource.org/licenses/OSL-3.0\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@prestashop.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade PrestaShop to newer\n * versions in the future. If you wish to customize PrestaShop for your\n * needs please refer to http://www.prestashop.com for more information.\n *\n * @author    PrestaShop SA <contact@prestashop.com>\n * @copyright 2007-2018 PrestaShop SA\n * @license   https://opensource.org/licenses/OSL-3.0 Open Software License (OSL 3.0)\n * International Registered Trademark & Property of PrestaShop SA\n */\n\nimport SpecificPriceFormHandler from './specific-price-form-handler';\n\nconst $ = window.$;\n\n$(() => {\n  new SpecificPriceFormHandler();\n});\n"],"sourceRoot":""}